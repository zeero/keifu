[remote.github]
owner = "trasta298"
repo = "keifu"

[changelog]
header = """
# Changelog\n
"""
body = """
{%- for group, group_commits in commits | group_by(attribute="group") %}
{%- set merge_commits = group_commits | filter(attribute="merge_commit", value=true) %}
{%- if merge_commits | length > 0 %}
### {{ group | upper_first }}
{% for commit in merge_commits %}
- {{ commit.remote.pr_title | split(pat="\n") | first | upper_first }} ([#{{ commit.remote.pr_number }}](https://github.com/trasta298/keifu/pull/{{ commit.remote.pr_number }}))
{%- endfor %}
{% endif %}
{%- endfor %}
"""
footer = ""
trim = true

[git]
conventional_commits = true
filter_unconventional = false
split_commits = false
commit_preprocessors = [
  # Remove Co-Authored-By lines
  { pattern = "\n*Co-Authored-By:.*", replace = "" },
  # Remove Claude Code signature
  { pattern = "\n*ğŸ¤– Generated with \\[Claude Code\\].*", replace = "" },
  # Remove trailing whitespace and empty lines at the end
  { pattern = "\\s+$", replace = "" },
]
commit_parsers = [
  # Skip release version bumps and WIP
  { message = "^ğŸ”–", skip = true },
  { message = "^chore\\(release\\)", skip = true },
  { message = "^ğŸš§", skip = true },
  # Group merge commits by PR title pattern
  { field = "remote.pr_title", pattern = "^âœ¨|^feat", group = "âœ¨ Features" },
  { field = "remote.pr_title", pattern = "^ğŸ›|^fix", group = "ğŸ› Bug Fixes" },
  { field = "remote.pr_title", pattern = "^ğŸ“|^docs?", group = "ğŸ“ Documentation" },
  { field = "remote.pr_title", pattern = "^â™»ï¸|^refactor", group = "â™»ï¸ Refactoring" },
  { field = "remote.pr_title", pattern = "^ğŸ¨|^style", group = "ğŸ¨ Styling" },
  { field = "remote.pr_title", pattern = "^âš¡|^perf", group = "âš¡ Performance" },
  { field = "remote.pr_title", pattern = "^ğŸ§ª|^test", group = "ğŸ§ª Testing" },
  { field = "remote.pr_title", pattern = "^ğŸ‘·|^ci", group = "ğŸ‘· CI/CD" },
  { field = "remote.pr_title", pattern = "^ğŸ”’", group = "ğŸ”’ Security" },
  { field = "remote.pr_title", pattern = "^ğŸ”§|^chore", group = "ğŸ”§ Miscellaneous" },
  { field = "remote.pr_title", pattern = "^ğŸ—‘ï¸", group = "ğŸ—‘ï¸ Removed" },
  { field = "remote.pr_title", pattern = ".*", group = "ğŸ“¦ Other" },
  # Non-merge commits: emoji prefix (gitmoji style)
  { message = "^âœ¨", group = "âœ¨ Features" },
  { message = "^ğŸ›", group = "ğŸ› Bug Fixes" },
  { message = "^ğŸ“", group = "ğŸ“ Documentation" },
  { message = "^â™»ï¸", group = "â™»ï¸ Refactoring" },
  { message = "^ğŸ¨", group = "ğŸ¨ Styling" },
  { message = "^âš¡", group = "âš¡ Performance" },
  { message = "^ğŸ§ª", group = "ğŸ§ª Testing" },
  { message = "^ğŸ‘·", group = "ğŸ‘· CI/CD" },
  { message = "^ğŸ”’", group = "ğŸ”’ Security" },
  { message = "^ğŸ”§", group = "ğŸ”§ Configuration" },
  { message = "^ğŸ“„", group = "ğŸ“ Documentation" },
  { message = "^ğŸ—‘ï¸", group = "ğŸ—‘ï¸ Removed" },
  # Non-merge commits: conventional commits
  { message = "^feat", group = "âœ¨ Features" },
  { message = "^fix", group = "ğŸ› Bug Fixes" },
  { message = "^docs?", group = "ğŸ“ Documentation" },
  { message = "^perf", group = "âš¡ Performance" },
  { message = "^refactor", group = "â™»ï¸ Refactoring" },
  { message = "^style", group = "ğŸ¨ Styling" },
  { message = "^test", group = "ğŸ§ª Testing" },
  { message = "^ci", group = "ğŸ‘· CI/CD" },
  { message = "^chore", group = "ğŸ”§ Miscellaneous" },
  # Catch-all
  { message = ".*", group = "ğŸ“¦ Other" },
]
filter_commits = false
tag_pattern = "v[0-9].*"
skip_tags = ""
ignore_tags = ""
topo_order = false
sort_commits = "oldest"
